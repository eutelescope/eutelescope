<?xml version="1.0" encoding="us-ascii"?>
<!-- ?xml-stylesheet type="text/xsl" href="http://ilcsoft.desy.de/marlin/marlin.xsl"? -->
<!-- ?xml-stylesheet type="text/xsl" href="marlin.xsl"? -->

<!--
============================================================================================================================
   Steering File generated by Marlin GUI on Fri Jun 16 09:44:07 2017

   WARNING: - Please be aware that comments made in the original steering file were lost.
            - Processors that are not installed in your Marlin binary lost their parameter's descriptions and types as well.
            - Extra parameters that aren't categorized as default in a processor lost their description and type.
============================================================================================================================
-->


<marlin xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://ilcsoft.desy.de/marlin/marlin.xsd">

   <execute>
      <processor name="MyAIDAProcessor"/>
      <processor name="MyAlibavaFilter"/>
      <processor name="Save"/>
   </execute>

   <global>
      <parameter name="LCIOInputFiles"> @AlibavaLcioRawFolder@/run@RunNumber@.slcio </parameter>
      <parameter name="ChannelsToBeUsed" value="@Bonds@"/>
      <parameter name="GearXMLFile" value="@GearFilePath@/@GearFile@"/>
      <parameter name="MaxRecordNumber" value="@MaxRecordNumber@"/>
      <parameter name="SkipMaskedEvents" value="0"/>
      <parameter name="SkipNEvents" value="@SkipNEvents@"/>
      <parameter name="SupressCheck" value="false"/>
      <parameter name="Verbosity" value="@Verbosity@"/>
   </global>

 <processor name="MyAIDAProcessor" type="AIDAProcessor">
 <!--Processor that handles AIDA files. Creates on directory per processor.  Processors only need to create and fill the histograms, clouds and tuples. Needs to be the first ActiveProcessor-->
  <!-- compression of output file 0: false >0: true (default) -->
  <parameter name="Compress" type="int" value="1"/>
  <!-- filename without extension-->
  <parameter name="FileName" type="string" value="@AlibavaHistoPath@/@Output@-alibava-rghfiltered"/>
  <!-- type of output file root (default) or xml )-->
  <parameter name="FileType" type="string" value="root"/>
  <!--verbosity level of this processor ("DEBUG0-4,MESSAGE0-4,WARNING0-4,ERROR0-4,SILENT")-->
  <!--parameter name="Verbosity" type="string" value=""/-->
</processor>

 <processor name="MyAlibavaFilter" type="AlibavaFilter">
 <!--AlibavaFilter filters input data to eliminate crosstalk and non-gaussian noise (Random Ghost Hits)! -->
  <!--Input reco data collection name-->
  <parameter name="InputCollectionName" type="string" lcioInType="TrackerData"> recodata_cmmd </parameter>
  <!--Output filtered data collection name-->
  <parameter name="OutputCollectionName" type="string" lcioOutType="TrackerData"> recodata_cmmd_rghfiltered </parameter>
  <!--First correction value-->
  <!--parameter name="Coefficient1" type="float" value="0.0373"/-->
  <!--Second correction value-->
  <!--parameter name="Coefficient2" type="float" value="0.0162"/-->
  <!--The filename to read/write coefficients to-->
  <!--parameter name="FIRCoefficientFile" type="string" value="filtercoefficients.txt"/-->
  <!--The maximum ADC in a channel to be allowed. Higher ADCs will be set to 0 if RGH filtering is used.-->
  <parameter name="MaxRGHADC" type="float" value="150"/>
  <!--The maximum signal a channel is allowed to have. This factor times a channels noise is the limit. Should be larger than the cluster seed limit, otherwise no clusters will be found.-->
  <!--parameter name="MaxSignalFactor" type="float" value="10"/-->
  <!--The highest number of cluster candidates in an event allowed before discarding it in RGH filtering.-->
  <parameter name="MaxSuspects" type="int" value="7"/>
  <!--The minimum noise a channel has to have to consider RGH filtering. Set to 0 to do all good channels.-->
  <parameter name="MinRGHnoise" type="float" value="6"/>
  <!--The ratio of noise in negative ADCs required for a neighbour to cut a seed.-->
  <!--parameter name="NegativeNoise" type="float" value="2"/-->
  <!--Noise collection name-->
  <parameter name="NoiseCollectionName" type="string" value="noise_cmmd"/>
  <!--The filename where the final noise is stored-->
  <parameter name="NoiseInputFile" type="string" value="@AlibavaLcioRawFolder@/ped@PedRunNumberFormatted@-cmmd.slcio"/>
  <!--Set to true to use RGH filtering instead of FIR filtering. RGH filtering assumes a polarity of +1!-->
  <parameter name="RGHfilter" type="bool" value="true"/>
  <!--FIR filter coefficients from a previous iteration can be read if this is switched on.-->
  <!--parameter name="ReadFIRCoefficients" type="bool" value="false"/-->
  <!--The used cluster seed cut, used to determine the number of cluster candidates in RGH filtering-->
  <!--parameter name="SeedCut" type="float" value="5"/-->
  <!--Set to true to use Coefficient1 and Coefficient2 or read from file. This should be sufficient for most applications. If false, then the (define nc N) filter coefficients in the source code will be used.-->
  <parameter name="UseSimpleMethod" type="bool" value="false"/>
  <!--verbosity level of this processor ("DEBUG0-4,MESSAGE0-4,WARNING0-4,ERROR0-4,SILENT")-->
  <!--parameter name="Verbosity" type="string" value=""/-->
</processor>

 <processor name="Save" type="LCIOOutputProcessor">
 <!--Writes the current event to the specified LCIO outputfile. Needs to be the last ActiveProcessor.-->
  <!--drops the named collections from the event-->
  <!--parameter name="DropCollectionNames" type="StringVec"> TPCHits HCalHits </parameter-->
  <!--drops all collections of the given type from the event-->
  <!--parameter name="DropCollectionTypes" type="StringVec"> SimTrackerHit SimCalorimeterHit </parameter-->
  <!-- write complete objects in subset collections to the file (i.e. ignore subset flag)-->
  <!--parameter name="FullSubsetCollections" type="StringVec" value="MCParticlesSkimmed"/-->
  <!--force keep of the named collections - overrules DropCollectionTypes (and DropCollectionNames)-->
  <!--parameter name="KeepCollectionNames" type="StringVec" value="MyPreciousSimTrackerHits"/-->
  <!-- name of output file -->
  <parameter name="LCIOOutputFile" type="string" value="@AlibavaLcioRawFolder@/run@RunNumber@-rghfiltered.slcio"/>
  <!--write mode for output file:  WRITE_APPEND or WRITE_NEW-->
  <parameter name="LCIOWriteMode" type="string" value="WRITE_NEW"/>
  <!--will split output file if size in kB exceeds given value - doesn't work with APPEND and NEW-->
  <!--parameter name="SplitFileSizekB" type="int" value="1992294"/-->
  <!--verbosity level of this processor ("DEBUG0-4,MESSAGE0-4,WARNING0-4,ERROR0-4,SILENT")-->
  <!--parameter name="Verbosity" type="string" value=""/-->
</processor>

</marlin>
